<!DOCTYPE html>
<html lang="nl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://fonts.xz.style/serve/inter.css" />
    <title>Somlo</title>
    <link rel="icon" type="image/x-icon" href="logo.png" />
    <link rel="stylesheet" href="css.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/css.min.js"></script>
    <script>
      hljs.highlightAll();
    </script>
    <style>
      body,
      html {
        font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont,
          "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans",
          "Helvetica Neue", sans-serif;
      }

      .cancelled {
        background-color: red !important; /* Light red */
        color: white;
      }

      @media (prefers-color-scheme: dark) {
        body,
        html {
          background-color: #000000 !important;
          color: #ffffff;
        }

        #schedule div {
          background-color: #333 !important;
        }

        #schedule .cancelled {
          background-color: red !important;
        }
      }

      #schedule div {
        padding: 10px;
        border-radius: 10px;
        margin-bottom: 10px;
        background-color: #eee;
      }

      strong {
        font-size: x-large;
      }

      p {
        margin: 0;
      }

      #field span {
        font-family: "Pluto", system-ui, -apple-system, BlinkMacSystemFont,
          "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans",
          "Helvetica Neue", sans-serif;
        color: #1080ce;
        font-size: 2rem;
        vertical-align: bottom;
        margin-right: 10px;
      }

      @font-face {
        font-family: "Pluto";
        src: url("https://blissradio.github.io/PlutoBold.woff2") format("woff2");
        font-weight: normal;
        font-style: normal;
        font-display: swap;
      }
      h1 {
        margin: 0;
      }
      #field {
        margin-bottom: 10px;
      }

      button {
        font-family: inherit;
        font-size: inherit;
      }

      .btn {
        background-color: #f1f1f1;
        border: 0;
        padding: 0.5rem 1rem;
        line-height: 1.5;
        border-radius: 4rem;
        transition: all 0.33s ease-in-out 0s, top 0.33s ease-out 0.33s;
        text-decoration: none !important;
      }

      #previousDay,
      #nextDay {
        transition: all 0.33s ease-in-out 0s, top 0.33s ease-out 0.33s;
      }

      button:not(:disabled) {
        cursor: pointer;
      }

      .btn:hover {
        text-decoration: none;
        background-color: #f1f1f1;
      }

      button:not(:disabled):not(.disabled) {
        cursor: pointer;
      }

      .btn:hover,
      .btn:active {
        background-color: #f1f1f1;
        text-decoration: none;
      }

      @media (prefers-color-scheme: dark) {
        dialog {
          background-color: #000000a1 !important;
          color: white;
        }

        .btn {
          color: white !important;
          background-color: #363636 !important;
          text-shadow: none !important;
        }

        .btn:hover {
          color: white !important;
          background-color: #444 !important;
        }

        .btn:hover,
        .btn:active,
        #previousDay:hover,
        #nextDay:hover {
          color: white !important;
          background-color: #444 !important;
        }

        #close:hover {
          background-color: red !important;
        }

        #icon,
        .icon {
          fill: white !important;
        }

        #previousDay,
        #nextDay {
          background-color: #363636 !important;
        }
      }

      #icon,
      .icon {
        fill: black;
        vertical-align: middle;
      }

      input {
        font-family: inherit;
      }

      #settingsButton {
        position: absolute;
        right: 0px;
      }

      .hide {
        display: none;
      }

      #className {
        display: none;
      }

      details summary {
        cursor: pointer;
      }

      @media (max-width: 481px) {
        #field span {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <!-- Date input field -->
    <div id="field">
      <svg
        version="1.1"
        viewBox="0 0 410 374"
        xmlns="http://www.w3.org/2000/svg"
        style="vertical-align: middle; width: 2rem"
      >
        <path
          transform="translate(29)"
          d="m0 0h11l1 1s0.87292 21.372 2 32c0.71092 6.7037 1.6523 13.395 3 20 1.8588 9.1098 7 27 7 27l0.55532 2h1.4447s0.27448-4.1067 1-6c1.5552-4.0584 4.4126-7.508 7-11 3.6591-4.9385 7.6044-9.7039 12-14 3.3881-3.3114 7.2291-6.1322 11-9 5.521-4.1988 11.159-8.2586 17-12 6.1622-3.9474 12.448-7.7402 19-11 6.1525-3.061 12.518-5.7186 19-8 6.8672-2.4169 13.906-4.3652 21-6 5.6073-1.2921 11.318-2.093 17-3 2.3276-0.37152 4.6489-0.83291 7-1 11.97-0.85067 24.03-0.85067 36 0 7.0533 0.50126 14.084 1.5253 21 3 7.12 1.5183 14.111 3.645 21 6 6.7942 2.3226 13.485 4.9826 20 8 5.8182 2.6945 11.536 5.6444 17 9 5.9105 3.6301 11.527 7.7383 17 12 4.8494 3.7764 9.4903 7.8239 14 12 1.3835 1.2812 4 4 4 4v2l-236 1s-10.921 1.8962-16 4c-3.5914 1.4876-7.1564 3.3496-10 6-2.9765 2.7742-5.2262 6.3381-7 10-1.5171 3.132-2.4946 6.5568-3 10-0.77447 5.2768-1.0724 10.776 0 16 0.51042 2.4868 1.8684 4.7276 3 7 2.3959 4.8113 5.0212 9.5261 8 14 3.0299 4.5506 6.5667 8.7454 10 13 3.5648 4.4175 7.1564 8.8228 11 13 2.5535 2.7752 5.2038 5.4695 8 8 3.5127 3.1789 7.2887 6.0554 11 9 4.2828 3.398 8.51 6.8809 13 10 5.1653 3.5882 10.583 6.8051 16 10 5.9122 3.4867 11.865 6.9223 18 10 6.5344 3.2781 13.241 6.2151 20 9 7.8998 3.2548 15.946 6.1486 24 9 0.99366 0.35179 3 1 3 1l-1.5553 6.4447-1.4447 5.5553s-10.069-3.1384-15-5c-8.8039-3.3238-17.454-7.0605-26-11-5.4152-2.4963-10.733-5.2042-16-8-5.4049-2.8691-10.807-5.7634-16-9-5.4927-3.4233-10.786-7.1654-16-11-4.781-3.5162-9.4826-7.1509-14-11-4.4888-3.8248-8.7475-7.9142-13-12-2.7194-2.6128-5.4972-5.1789-8-8-3.9386-4.4395-7.4207-9.266-11-14-2.7344-3.6165-5.4979-7.2191-8-11-3.2179-4.8626-6.2634-9.8511-9-15-2.5896-4.8722-4.9194-9.8897-7-15-2.6635-6.5418-4.8622-13.268-7-20-1.469-4.6258-2.8565-9.2832-4-14-1.6018-6.6073-2.9428-13.284-4-20-1.3566-8.618-3-26-3-26z"
          fill="#1080ce"
        />
        <path
          d="m0 0h14s0.78778 22.047 2 33c1.1514 10.403 2.7865 20.77 5 31 1.6074 7.4293 3.6442 14.773 6 22 2.3216 7.1219 4.9879 14.142 8 21 2.3977 5.4596 5.1094 10.785 8 16 3.4087 6.1502 7.0527 12.181 11 18 2.8068 4.1379 5.8714 8.0998 9 12 3.8459 4.7944 7.8239 9.4903 12 14 3.8435 4.1506 7.8057 8.2042 12 12 3.5127 3.1789 7.2708 6.0781 11 9 5.2477 4.1117 10.483 8.2576 16 12 5.8192 3.9473 11.947 7.4219 18 11 4.627 2.735 9.2221 5.5382 14 8 8.4851 4.372 17.232 8.2262 26 12 6.5952 2.8388 13.258 5.5303 20 8 2.9693 1.0877 9 3 9 3l-2.7223 9.0564-2.2777 6.9436h-165s-4.3065-10.562-6-16c-1.6345-5.2489-2.8806-10.618-4-16-1.2386-5.9553-2.266-11.962-3-18-0.52443-4.3144-0.83321-8.6571-1-13-0.20468-5.3294-0.27954-10.674 0-16 0.33379-6.3596 1.0412-12.704 2-19 1.0236-6.7212 2.3315-13.409 4-20 1.1127-4.3952 4-13 4-13s-1.2377-4.0345-2-6c-2.3743-6.1216-5.6257-11.878-8-18-3.0493-7.8621-5.7677-15.868-8-24-2.0769-7.5659-3.5542-15.289-5-23-1.1815-6.302-2.2709-12.63-3-19-0.53199-4.6482-1-14-1-14z"
          fill="#3469ed"
        />
        <path
          transform="translate(216,150)"
          d="m0 0 5 1s13.45 5.0586 20 8c5.4395 2.4427 10.698 5.2715 16 8 5.7012 2.9339 11.512 5.6844 17 9 6.5682 3.9683 12.79 8.4922 19 13 4.4244 3.2115 8.8302 6.4642 13 10 5.2165 4.4234 10.081 9.2479 15 14 2.7122 2.6203 5.4972 5.1789 8 8 3.9386 4.4395 7.518 9.194 11 14 3.5257 4.8663 6.818 9.9024 10 15 2.4521 3.9283 4.9065 7.8694 7 12 3.7794 7.4569 7.0706 15.17 10 23 2.3272 6.2205 4.3463 12.568 6 19 2.116 8.2307 3.5202 16.631 5 25 0.76344 4.3173 1.4843 8.6461 2 13 0.47212 3.986 0.83319 7.9896 1 12 0.27706 6.6609 0 20 0 20h-11l-1.1851 0.11075s-0.21932-15.425-0.81487-23.111c-0.64845-8.368-1.568-16.73-3-25-1.2831-7.4101-3.2546-14.685-5-22-0.95694-4.0105-3-12-3-12h-2l-2.2754 4.4113-7.9497 12.364s-3.0941 4.2216-4.7748 6.2252c-0.47167 0.56227-1.4873 1.6234-1.4873 1.6234s-1.0364 0.88879-1.5127 1.3766c-0.31605 0.3237-0.88925 1.0253-0.88925 1.0253l-1.1108 0.97469s-0.98471 1.032-1.4873 1.538c-0.82644 0.83187-1.6599 1.6572-2.5127 2.462-3.6037 3.4013-7.1352 6.8986-11 10-5.4098 4.3411-11.063 8.4128-17 12-8.0096 4.8398-16.447 8.9769-25 12.775-6.1927 2.7499-12.535 5.1957-19 7.2252-6.5564 2.0582-13.237 3.7845-20 5-8.9126 1.6017-17.958 2.4992-27 3-5.3252 0.29494-10.675 0.30617-16 0-8.7098-0.50083-17.408-1.487-26-3-7.0866-1.2479-14.123-2.8814-21-5-7.1587-2.2055-14.17-4.9234-21-8-7.2049-3.2456-14.239-6.9099-21-11-4.5096-2.7279-8.773-5.8519-13-9-3.4236-2.5498-6.7263-5.2605-10-8-2.7174-2.274-8-7-8-7v-2l231-1s7.5123-0.68668 11-2c3.6379-1.3699 6.936-3.6077 10-6 3.7156-2.9011 7.1936-6.2124 10-10 3.3735-4.5531 5.9642-9.7116 8-15 0.49375-1.2826 0.92988-2.6274 1-4 0.25384-4.9692-0.61416-10.034-2.1258-14.775-2.1887-6.8637-6.0164-13.141-9.8742-19.225-2.9276-4.6172-6.5532-8.7564-10-13-3.8751-4.7709-7.8239-9.4903-12-14-2.2421-2.4212-4.5533-4.7858-7-7-3.5127-3.1789-7.2887-6.0554-11-9-4.2828-3.398-8.5033-6.8905-13-10-6.7714-4.6825-13.864-8.8941-21-13-4.9116-2.8261-9.8911-5.5483-15-8-9.1548-4.3932-28-12-28-12l-5-2 1.4503-5.8742z"
          fill="#3469ed"
        />
        <path
          transform="translate(226,120)"
          d="m0 0h152s2.891 5.91 4 9c2.1036 5.8611 3.6789 11.915 5 18 1.3603 6.2658 2.1807 12.641 3 19 0.42807 3.3225 0.83313 6.6542 1 10 0.3653 7.3242 0.43765 14.68 0 22-0.50089 8.3782-1.5365 16.735-3 25-1.015 5.7322-2.5333 11.366-4 17-0.61141 2.3484-2 7-2 7s7.102 13.809 10 21c3.546 8.7992 6.4887 17.852 9 27 2.0769 7.5659 3.5542 15.289 5 23 1.1815 6.302 2.2709 12.63 3 19 0.53199 4.6482 1 14 1 14v23h-14s-0.73167-22.718-2-34c-1.1326-10.074-2.8302-20.097-5-30-1.6269-7.425-3.6442-14.773-6-22-2.3216-7.1219-4.988-14.142-8-21-2.3977-5.4596-5.1629-10.755-8-16-2.2033-4.0731-4.4957-8.1047-7-12-3.751-5.8345-7.7383-11.527-12-17-3.7764-4.8494-7.8239-9.4903-12-14-4.1638-4.4964-8.4562-8.8879-13-13-3.5127-3.1789-7.2887-6.0554-11-9-4.2828-3.398-8.5174-6.8703-13-10-6.1419-4.2882-12.536-8.214-19-12-7.8506-4.5984-15.829-8.9979-24-13-8.1762-4.0048-16.606-7.4755-25-11-3.3102-1.3898-10-4-10-4l2.1106-8 1.8894-7z"
          fill="#1080ce"
        /></svg
      ><span>Somlo</span>
      <input
        type="text"
        id="dateInput"
        name="dateInput"
        placeholder="bijv. 5 juni"
        class="btn"
        size="9"
        autocomplete="off"
        style="text-align: center"
      />
      <button
        id="previousDay"
        style="
          border: none;
          border-radius: 4rem 0 0 4rem;
          padding: 0.5rem;
          background-color: #f1f1f1;
        "
      >
        <svg
          width="24"
          height="24"
          fill="none"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
          id="icon"
        >
          <path
            d="M15.707 4.293a1 1 0 0 1 0 1.414L9.414 12l6.293 6.293a1 1 0 0 1-1.414 1.414l-7-7a1 1 0 0 1 0-1.414l7-7a1 1 0 0 1 1.414 0Z"
          />
        </svg></button
      ><button
        id="nextDay"
        style="
          border: none;
          padding: 0.5rem;
          border-radius: 0 4rem 4rem 0;
          background-color: #f1f1f1;
        "
      >
        <svg
          width="24"
          height="24"
          fill="none"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
          id="icon"
        >
          <path
            d="M8.293 4.293a1 1 0 0 0 0 1.414L14.586 12l-6.293 6.293a1 1 0 1 0 1.414 1.414l7-7a1 1 0 0 0 0-1.414l-7-7a1 1 0 0 0-1.414 0Z"
          />
        </svg>
      </button>
      <button id="loadSchedule" class="btn">
        <svg
          width="24"
          height="24"
          fill="none"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
          id="icon"
        >
          <path
            d="m8.5 16.586-3.793-3.793a1 1 0 0 0-1.414 1.414l4.5 4.5a1 1 0 0 0 1.414 0l11-11a1 1 0 0 0-1.414-1.414L8.5 16.586Z"
          />
        </svg>
      </button>
      <button class="btn" onclick="showDialog()" id="settingsButton">
        <svg
          width="24"
          height="24"
          fill="none"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
          id="icon"
        >
          <path
            d="M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.401-.615a.75.75 0 0 1 .85.174 9.792 9.792 0 0 1 2.204 3.792.75.75 0 0 1-.271.825l-1.242.916a1.381 1.381 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826 9.797 9.797 0 0 1-2.204 3.792.75.75 0 0 1-.848.175l-1.407-.617a1.38 1.38 0 0 0-1.926 1.114l-.169 1.526a.75.75 0 0 1-.572.647 9.518 9.518 0 0 1-4.406 0 .75.75 0 0 1-.572-.647l-.168-1.524a1.382 1.382 0 0 0-1.926-1.11l-1.406.616a.75.75 0 0 1-.849-.175 9.798 9.798 0 0 1-2.204-3.796.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.271-.826 9.793 9.793 0 0 1 2.204-3.792.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.717-.159 1.45-.243 2.201-.252ZM12 9a3 3 0 1 0 0 6 3 3 0 0 0 0-6Z"
          />
        </svg>
      </button>
    </div>
    <noscript
      ><p>
        <svg
          width="24"
          height="24"
          fill="none"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M3 6.25v11.5A3.25 3.25 0 0 0 6.25 21h11.5A3.25 3.25 0 0 0 21 17.75V6.25A3.25 3.25 0 0 0 17.75 3H6.25A3.25 3.25 0 0 0 3 6.25Zm9 3.25a.75.75 0 0 1 .75.75v6A1.75 1.75 0 0 1 11 18H9.75a.75.75 0 0 1 0-1.5H11a.25.25 0 0 0 .25-.25v-6A.75.75 0 0 1 12 9.5Zm2 1.75c0-.966.784-1.75 1.75-1.75h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v1.5c0 .138.112.25.25.25h.5c.966 0 1.75.784 1.75 1.75v1.5A1.75 1.75 0 0 1 16.25 18h-1.5a.75.75 0 0 1 0-1.5h1.5a.25.25 0 0 0 .25-.25v-1.5a.25.25 0 0 0-.25-.25h-.5A1.75 1.75 0 0 1 14 12.75v-1.5Z"
            fill="#f7df38"
          /></svg
        >Zet Javascript aan om je rooster te bekijken.
      </p></noscript
    >
    <dialog
      id="dialog"
      role="dialog"
      aria-label="Voer je schoolnaam en koppelcode in."
      style="
        border: 0;
        border-radius: 2rem;
        background-color: #ffffffa1;
        backdrop-filter: blur(10px);
      "
    >
      <button
        class="btn"
        style="
          background-color: #ddd;
          position: absolute;
          right: 70px;
          padding-bottom: 10px;
          top: 8px;
        "
      >
        <svg
          width="24"
          height="24"
          fill="none"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
          id="icon"
        >
          <path
            d="M12 4C9.238 4 7 6.238 7 9a1 1 0 0 0 2 0c0-1.658 1.342-3 3-3s3 1.342 3 3c0 .816-.199 1.294-.438 1.629-.262.365-.625.638-1.128.985l-.116.078c-.447.306-1.023.699-1.469 1.247-.527.648-.849 1.467-.849 2.561v.5a1 1 0 1 0 2 0v-.5c0-.656.178-1.024.4-1.299.257-.314.603-.552 1.114-.903l.053-.037c.496-.34 1.133-.786 1.62-1.468C16.7 11.081 17 10.183 17 9c0-2.762-2.238-5-5-5ZM12 21.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5Z"
          />
        </svg>
      </button>
      <button
        class="btn"
        onclick="hideDialog()"
        id="close"
        style="
          background-color: #ddd;
          position: absolute;
          right: 8px;
          padding-bottom: 10px;
          top: 8px;
        "
      >
        <svg
          width="24"
          height="24"
          fill="none"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
          id="icon"
        >
          <path
            d="m4.21 4.387.083-.094a1 1 0 0 1 1.32-.083l.094.083L12 10.585l6.293-6.292a1 1 0 1 1 1.414 1.414L13.415 12l6.292 6.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.32.083l-.094-.083L12 13.415l-6.293 6.292a1 1 0 0 1-1.414-1.414L10.585 12 4.293 5.707a1 1 0 0 1-.083-1.32l.083-.094-.083.094Z"
          />
        </svg></button
      ><br /><br />
      <label for="schoolName">Schoolnaam:</label>
      <input
        type="text"
        id="schoolName"
        name="schoolName"
        class="btn"
        style="background-color: #ddd"
        required
      /><br /><br />

      <label for="authorizationCode">Koppelcode:</label>
      <input
        type="text"
        id="authorizationCode"
        name="authorizationCode"
        class="btn"
        style="background-color: #ddd"
        required
      /><br /><br />

      <label for="user">Gebruikersnaam:</label>
      <input
        type="text"
        id="user"
        name="user"
        class="btn"
        style="background-color: #ddd"
        value="~me"
        required
      /><br /><br /><label for="css">CSS-code (optioneel):</label><br /><br />
      <input
        type="text"
        autocomplete="off"
        style="width: 90%; background-color: #ddd"
        oninput="update_section(this.value, 'about');"
        onclick="update_section(this.value, 'about');"
        id="css"
        class="btn"
      /><br /><br />
      <details>
        <summary>CSS voorbeelden</summary>
        <br />
        <p>Laat klassennamen zien:</p>
        <pre><code class="language-css">#className {display: initial;}</code></pre>
      </details>
      <br />
      <button onclick="hideDialog()" class="btn" style="background-color: #ddd">
        <svg
          width="24"
          height="24"
          fill="none"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
          id="icon"
        >
          <path
            d="M6.75 3h-1A2.75 2.75 0 0 0 3 5.75v12.5A2.75 2.75 0 0 0 5.75 21H6v-6a2.25 2.25 0 0 1 2.25-2.25h7.5A2.25 2.25 0 0 1 18 15v6h.25A2.75 2.75 0 0 0 21 18.25V8.286a3.25 3.25 0 0 0-.952-2.299l-2.035-2.035A3.25 3.25 0 0 0 15.75 3v4.5a2.25 2.25 0 0 1-2.25 2.25H9A2.25 2.25 0 0 1 6.75 7.5V3Z"
          />
          <path
            d="M14.25 3v4.5a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75V3h6ZM16.5 21v-6a.75.75 0 0 0-.75-.75h-7.5a.75.75 0 0 0-.75.75v6h9Z"
          />
        </svg>
        Opslaan
      </button>
    </dialog>
    <style id="aboutgoeshere"></style>
    <strong id="error-message" style="text-align: center"
      ><img
        src="https://csvincentvangogh.zportal.nl/app/img/es_geenresultaten.png"
        alt="Geen rooster gevonden"
        style="text-align: center"
      /><br />
      Geen rooster gevonden voor deze dag.</strong
    >
    <div id="schedule">
      <!-- Appointments will be displayed here -->
    </div>

    <script>
      // Dutch month names
      const dutchMonthNames = [
        "januari",
        "februari",
        "maart",
        "april",
        "mei",
        "juni",
        "juli",
        "augustus",
        "september",
        "oktober",
        "november",
        "december",
      ];

      // Function to fetch appointments for the specified date
      function fetchAppointments(date) {
        // Parse the input date string to get the date and month
        const [day, monthName] = date.split(" ");
        const monthIndex = dutchMonthNames.findIndex(
          (month) => month.toLowerCase() === monthName.toLowerCase()
        );

        if (monthIndex === -1 || isNaN(parseInt(day))) {
          console.error(
            "Invalid date format. Please enter date in the format 'DD Month', e.g., '12 augustus'."
          );
          return;
        }

        const currentDate = new Date();
        const currentYear = currentDate.getFullYear();

        // Construct a Date object with the specified date and current year
        const startDate = new Date(currentYear, monthIndex, parseInt(day, 10));
        const endDate = new Date(startDate);
        endDate.setDate(endDate.getDate() + 1);
        const user = document.getElementById("user").value;
        const schoolName = document.getElementById("schoolName").value;
        const authorizationCode =
          document.getElementById("authorizationCode").value;
        const startTimestamp = Math.floor(startDate.getTime() / 1000);
        const endTimestamp = Math.floor(endDate.getTime() / 1000);

        const apiUrl = `https://${schoolName}.zportal.nl/api/v3/appointments?user=${user}&start=${startTimestamp}&end=${endTimestamp}&valid=true&fields=subjects,cancelled,locations,startTimeSlot,start,end,groups,teachers,changeDescription&access_token=${authorizationCode}`;

        fetch(apiUrl)
          .then((response) => response.json())
          .then((data) => {
            const appointments = data.response.data;
            // Sort appointments by start time
            appointments.sort((a, b) => a.start - b.start);
            const scheduleDiv = document.getElementById("schedule");
            scheduleDiv.innerHTML = ""; // Clear existing schedule
            const errorMessageDiv = document.getElementById("error-message");

            if (appointments.length === 0) {
              scheduleDiv.style.display = "none";
              errorMessageDiv.style.display = "block";
            } else {
              scheduleDiv.style.display = "block";
              errorMessageDiv.style.display = "none";
            }

            // Filter out cancelled lessons if there are multiple lessons for the same hour
            const filteredAppointments = filterCancelledLessons(appointments);

            filteredAppointments.forEach((appointment) => {
              const startTime = new Date(appointment.start * 1000);
              const endTime = new Date(appointment.end * 1000);

              // Format start and end times
              const startTimeString = startTime.toLocaleTimeString([], {
                hour: "2-digit",
                minute: "2-digit",
              });
              const endTimeString = endTime.toLocaleTimeString([], {
                hour: "2-digit",
                minute: "2-digit",
              });

              // Object met vak afkortingen en hun volledige namen
              const subjectsMapping = {
                ak: "Aardrijkskunde",
                en: "Engels",
                fa: "Frans",
                gd: "Godsdienst",
                gs: "Geschiedenis",
                ha: "Handvaardigheid",
                ict: "Informatiekunde",
                in: "Informatiekunde",
                kcv: "Klassieke Culturele Vorming",
                lo: "Lichamelijke opvoeding",
                men: "Mentorles",
                mn: "Mens en natuur",
                mu: "Muziek",
                ne: "Nederlands",
                te: "Tekenen/Techniek",
                wi: "Wiskunde",
                fr: "Frans",
                nl: "Nederlands",
                du: "Duits",
                bi: "Biologie",
                na: "Natuurkunde",
                sk: "Scheikunde",
                ec: "Economie",
                econ: "Economie",
                ma: "Maatschappijleer",
                be: "Beeldende Vorming",
                kv: "Kunstvakken",
                fi: "Filosofie",
                la: "Latijn",
                gr: "Grieks",
                PROJECT: "Project",
                rkn: "Rekentoets",
                pe: "Physical education",
                ontw: "Ontwerpen",
                ltc: "Latijn",
                gtc: "Grieks",
                entl: "Engels",
                ges: "Geschiedenis",
                fatl: "Frans",
                biol: "Biologie",
                netl: "Nederlands",
                gds: "Godsdienst",
                wis: "Wiskunde",
                die: "Diëtetiek",
                kubv: "Kunst: Beeldende Vakken",
                bg: "Begeleiding",
                sp: "Spaans",
              };

              // Map subjects abbreviations to full names
              const subjectsFullNames = appointment.subjects.map(
                (subject) => subjectsMapping[subject] || subject
              );

              let changeDescription = "";
              if (appointment.changeDescription) {
                changeDescription = `<p>${appointment.changeDescription}</p>`;
              }

              // Create appointment HTML
              const appointmentDiv = document.createElement("div");
              appointmentDiv.innerHTML = `
                <p><strong>${subjectsFullNames.join(
                  ", "
                )}</strong><strong style="position:absolute;right:25px;">${
                appointment.startTimeSlot
              }</strong></p>
                <p>${startTimeString} - ${endTimeString} <span style="margin-left: 10px;">${appointment.locations.join(
                ", "
              )} (${appointment.teachers.join(", ")})</span></p>
              <p id="className">${appointment.groups.join(", ")}</p>
              <p>
                ${
                  appointment.changeDescription
                    ? '<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="vertical-align: sub;"><path d="M10.909 2.782a2.25 2.25 0 0 1 2.975.74l.083.138 7.759 14.009a2.25 2.25 0 0 1-1.814 3.334l-.154.006H4.242A2.25 2.25 0 0 1 2.2 17.812l.072-.143L10.03 3.66a2.25 2.25 0 0 1 .879-.878ZM12 16.002a.999.999 0 1 0 0 1.997.999.999 0 0 0 0-1.997Zm-.002-8.004a1 1 0 0 0-.993.884L11 8.998 11 14l.007.117a1 1 0 0 0 1.987 0l.006-.117L13 8.998l-.007-.117a1 1 0 0 0-.994-.883Z" fill="#ff9800"/></svg>'
                    : ""
                } 
                ${appointment.changeDescription}
              </p>
              `;

              // Add cancelled class if appointment is cancelled
              if (appointment.cancelled === true) {
                appointmentDiv.classList.add("cancelled");
              }

              scheduleDiv.appendChild(appointmentDiv);
            });
          })
          .catch((error) => console.error("Error fetching data:", error));
      }

      // Function to filter out cancelled lessons if there are multiple lessons for the same hour
      function filterCancelledLessons(appointments) {
        const filteredAppointments = [];

        appointments.forEach((appointment) => {
          // Check if there is already an appointment for the same hour
          const existingAppointment = filteredAppointments.find(
            (appt) =>
              appt.startTimeSlot === appointment.startTimeSlot &&
              appt.start <= appointment.start &&
              appt.end >= appointment.end
          );

          if (existingAppointment) {
            // If there's already an appointment and it's not cancelled, keep it and discard the current one
            if (!existingAppointment.cancelled && appointment.cancelled) {
              return;
            }
            // If the existing appointment is cancelled, replace it with the current one
            if (existingAppointment.cancelled && !appointment.cancelled) {
              filteredAppointments.splice(
                filteredAppointments.indexOf(existingAppointment),
                1,
                appointment
              );
            }
          } else {
            filteredAppointments.push(appointment);
          }
        });

        return filteredAppointments;
      }

      // Function to handle loading schedule when button is clicked
      document
        .getElementById("loadSchedule")
        .addEventListener("click", function () {
          const dateInput = document.getElementById("dateInput").value;
          fetchAppointments(dateInput);
        });

      // Function to handle previous day button click
      document
        .getElementById("previousDay")
        .addEventListener("click", function () {
          const dateInput = document.getElementById("dateInput").value;
          const [day, month] = dateInput.split(" ");
          const monthIndex = dutchMonthNames.findIndex(
            (monthName) => monthName.toLowerCase() === month.toLowerCase()
          );
          const currentDate = new Date();
          currentDate.setFullYear(
            currentDate.getFullYear(),
            monthIndex,
            parseInt(day) - 1
          );
          const previousDay =
            currentDate.getDate() +
            " " +
            dutchMonthNames[currentDate.getMonth()];
          document.getElementById("dateInput").value = previousDay;
          fetchAppointments(previousDay);
        });

      // Function to handle next day button click
      document.getElementById("nextDay").addEventListener("click", function () {
        const dateInput = document.getElementById("dateInput").value;
        const [day, month] = dateInput.split(" ");
        const monthIndex = dutchMonthNames.findIndex(
          (monthName) => monthName.toLowerCase() === month.toLowerCase()
        );
        const currentDate = new Date();
        currentDate.setFullYear(
          currentDate.getFullYear(),
          monthIndex,
          parseInt(day) + 1
        );
        const nextDay =
          currentDate.getDate() + " " + dutchMonthNames[currentDate.getMonth()];
        document.getElementById("dateInput").value = nextDay;
        fetchAppointments(nextDay);
      });

      // Fetch appointments for today when the page loads
      document.addEventListener("DOMContentLoaded", function () {
        // Default to today's date
        const today = new Date();
        const day = today.getDate();
        const monthName = dutchMonthNames[today.getMonth()];
        const formattedDate = `${day} ${monthName}`;
        document.getElementById("dateInput").value = formattedDate;
        fetchAppointments(formattedDate);
      });

      // Sla schoolnaam en token op
      schoolName.value = localStorage.getItem("schoolName");
      schoolName.oninput = () => {
        localStorage.setItem("schoolName", schoolName.value);
      };

      authorizationCode.value = localStorage.getItem("authorizationCode");
      authorizationCode.oninput = () => {
        localStorage.setItem("authorizationCode", authorizationCode.value);
      };

      css.value = localStorage.getItem("css");
      css.oninput = () => {
        localStorage.setItem("css", css.value);
      };

      // Functie om dialoogvenster te tonen
      function showDialog() {
        const dialog = document.getElementById("dialog");
        dialog.showModal();
      }

      // Functie om dialoogvenster te verbergen
      function hideDialog() {
        const dialog = document.getElementById("dialog");
        dialog.close();
        document.getElementById("loadSchedule").click();
        document.getElementById("css").click();
      }
      document.addEventListener("DOMContentLoaded", function () {
        const schoolName = localStorage.getItem("schoolName") || "";
        const authorizationCode =
          localStorage.getItem("authorizationCode") || "";
        if (schoolName.trim() === "" || authorizationCode.trim() === "") {
          // Als een van de opgeslagen waarden leeg is, toon dialoogvenster
          showDialog();
        } else {
        }
      });

      function update_section(with_what, what) {
        document.getElementById(what + "goeshere").innerHTML = with_what;
      }

      document.addEventListener("DOMContentLoaded", function () {
        setTimeout(document.getElementById("css").click(), 0);
      });
    </script>
  </body>
</html>
